### 压测对比

------



###### 环境部署情况：

| 服务器 | 配置  | 说明             | 部署内容                                                     | 备注                    |
| ------ | ----- | ---------------- | ------------------------------------------------------------ | ----------------------- |
| ip地址 | 8c16g | 主要部署下游服务 | wrkgo服务 webserver(go) 请求方式：curl http://localhost:8000/hello.jsonSpringDemo服务 /data/apps/xxxx | 带宽速度1G/sec          |
| ip地址 | 8c16g | 主要部署网关服务 | 网关服务                                                     |                         |
| ip地址 | 8c16g | 主要做压测机     | wrk                                                          | 带宽速度限制100MB/sec； |



###### 测试结果：

```
每个场景都输出一个基本压测结果，然后在输出不同参数配置情况下压测的结果变化，压测结果有可比性；同时输出dstat -v 系统指标情况，查看JVM GC情况进行调优。
```

###### 测试报告：与同类型网关开源软件做性能极限对比 Rapid 和 Nginx、SpringCloud Gateway

- 结论： 无网关情况下： TPS:135174.89 
- 有网关情况下：Nginx TPS:119295.74 > Rapid TPS:103664.59 > SpringCloudGateway TPS:40919.64

  

###### **报告输出：**

**直接压测下游结果**

| 应用名称          | 线程数  | 连接数  | TPS       | 响应时间(ms) | 总请求数 | 失败请求数 | 通过率(%) | CPU使用率(%) | 内存使用率(%) | 网络流入 | 网络流出 |         |      |      |      |       |       |       |       |
| ----------------- | ------- | ------- | --------- | ------------ | -------- | ---------- | --------- | ------------ | ------------- | -------- | -------- | ------- | ---- | ---- | ---- | ----- | ----- | ----- | ----- |
| **avg**           | **50%** | **75%** | **90%**   | **99%**      | **max**  | **avg**    | **max**   | **avg**      | **max**       | **avg**  | **max**  | **avg** |      |      |      |       |       |       |       |
| **webserver(go)** | **8**   | 3000    | 135174.89 | 22.36ms      | 19.93ms  | 21.73ms    | 33.45ms   | 46.04ms      | 4068758       | 0        | 100%     | 98%     | 97%  | 1.6% | 1.6% | 16M/s | 16M/s | 26M/s | 26M/s |



**压测Nginx**

| 应用名称  | 线程数  | 连接数  | TPS       | 响应时间(ms) | 总请求数 | 失败请求数 | 通过率(%) | CPU使用率(%) | 内存使用率(%) | 网络流入 | 网络流出 |         |      |      |      |       |       |       |       |
| --------- | ------- | ------- | --------- | ------------ | -------- | ---------- | --------- | ------------ | ------------- | -------- | -------- | ------- | ---- | ---- | ---- | ----- | ----- | ----- | ----- |
| **avg**   | **50%** | **75%** | **90%**   | **99%**      | **max**  | **avg**    | **max**   | **avg**      | **max**       | **avg**  | **max**  | **avg** |      |      |      |       |       |       |       |
| **Nginx** | **8**   | 3000    | 119295.74 | 94.31ms      | 19.00ms  | 27.04ms    | 338.70ms  | 972.34ms     | 3589283       | 0        | 100%     | 92%     | 88%  | 1.6% | 1.6% | 36M/s | 34M/s | 45M/s | 42M/s |



**压测Rapid**

| 应用名称   | 线程数  | 连接数  | TPS       | 响应时间(ms) | 总请求数 | 失败请求数 | 通过率(%) | CPU使用率(%) | 内存使用率(%) | 网络流入 | 网络流出 |         |      |      |      |       |       |       |       |
| ---------- | ------- | ------- | --------- | ------------ | -------- | ---------- | --------- | ------------ | ------------- | -------- | -------- | ------- | ---- | ---- | ---- | ----- | ----- | ----- | ----- |
| **avg**    | **50%** | **75%** | **90%**   | **99%**      | **max**  | **avg**    | **max**   | **avg**      | **max**       | **avg**  | **max**  | **avg** |      |      |      |       |       |       |       |
| **Rivers** | **8**   | 3000    | 103664.59 | 29.15ms      | 27.34ms  | 32.24ms    | 38.70ms   | 56.91ms      | 3113619       | 0        | 100%     | 96%     | 94%  | 8%   | 8%   | 37M/s | 35M/s | 46M/s | 43M/s |



**压测SpringCloudGateway**

| 应用名称               | 线程数  | 连接数  | TPS      | 响应时间(ms) | 总请求数 | 失败请求数 | 通过率(%) | CPU使用率(%) | 内存使用率(%) | 网络流入 | 网络流出 |         |      |      |      |       |       |       |       |
| ---------------------- | ------- | ------- | -------- | ------------ | -------- | ---------- | --------- | ------------ | ------------- | -------- | -------- | ------- | ---- | ---- | ---- | ----- | ----- | ----- | ----- |
| **avg**                | **50%** | **75%** | **90%**  | **99%**      | **max**  | **avg**    | **max**   | **avg**      | **max**       | **avg**  | **max**  | **avg** |      |      |      |       |       |       |       |
| **SpringCloudGateway** | **8**   | 3000    | 40919.64 | 48.27ms      | 46.64ms  | 56.81ms    | 68.35ms   | 94.02ms      | 1231666       | 0        | 100%     | 98%     | 96%  | 13%  | 13%  | 15M/s | 15M/s | 28M/s | 28M/s |

